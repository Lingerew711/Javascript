<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enhanced To-Do List Application</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400&display=swap" rel="stylesheet">
<style>
    body {
        font-family: 'Roboto', sans-serif;
    }
    .task-container {
        max-width: 350px;
        margin: 40px auto;
        padding: 20px;
        background: #f9f9f9;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .task-list {
        list-style: none;
        padding: 0;
    }
    .task-list li {
        padding: 10px;
        border-bottom: 1px solid #ccc;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: background-color 0.3s;
    }
    .task-list li:last-child {
        border-bottom: none;
    }
    .completed {
        text-decoration: line-through;
        color: #888;
    }
    .edit-mode {
        display: flex;
        align-items: center;
    }
    .edit-input {
        flex: 1;
    }
    .category-urgent { background-color: #FFC0CB; }
    .category-work { background-color: #ADD8E6; }
    .category-personal { background-color: #F0E68C; }
    .delete-button, .edit-button {
        cursor: pointer;
        margin-left: 10px;
    }
    .add-task-button, .filter-button {
        width: 100%;
        margin-top: 10px;
    }
    .filter-button {
        margin-right: 5px;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .task-list li {
        animation: fadeIn 0.5s;
    }
</style>
</head>
<body>
<div class="task-container">
    <input type="text" id="taskInput" placeholder="Enter new task">
    <select id="categoryInput">
        <option value="general">General</option>
        <option value="urgent">Urgent</option>
        <option value="work">Work</option>
        <option value="personal">Personal</option>
    </select>
    <button class="add-task-button" onclick="addTask()">Add Task</button>
    <div>
        <button class="filter-button" onclick="filterTasks('urgent')">Urgent</button>
        <button class="filter-button" onclick="filterTasks('work')">Work</button>
        <button class="filter-button" onclick="filterTasks('personal')">Personal</button>
        <button class="filter-button" onclick="sortTasks()">Sort by Date</button>
    </div>
    <ul id="taskList" class="task-list"></ul>
</div>

<script>
    document.getElementById('taskInput').addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
            addTask();
        }
    });

    let tasks = [];

    function addTask() {
        const taskInput = document.getElementById('taskInput');
        const categoryInput = document.getElementById('categoryInput');
        const taskText = taskInput.value.trim();
        const category = categoryInput.value;
        if (taskText) {
            const newTask = {
                text: taskText,
                category: category,
                completed: false
            };
            tasks.push(newTask);
            updateTaskList();
            taskInput.value = ''; // Clear input field
        }
    }

    function updateTaskList() {
        const taskList = document.getElementById('taskList');
        taskList.innerHTML = '';
        tasks.forEach((task, index) => {
            const categoryClass = `category-${task.category}`;
            const taskHTML = `
                <li class="${task.completed ? 'completed' : ''} ${categoryClass}">
                    <input type="checkbox" ${task.completed ? 'checked' : ''} onclick="toggleCompleted(${index})">
                    <span class="${task.editing ? 'hidden' : ''}">${task.text}</span>
                    <input type="text" class="edit-input ${task.editing ? '' : 'hidden'}" value="${task.text}">
                    <span class="edit-button" onclick="editTask(${index})">✎</span>
                    <span class="delete-button" onclick="deleteTask(${index})">X</span>
                </li>
            `;
            taskList.innerHTML += taskHTML;
        });
    }

    function toggleCompleted(index) {
        tasks[index].completed = !tasks[index].completed;
        updateTaskList();
    }

    function editTask(index) {
        tasks[index].editing = !tasks[index].editing;
        updateTaskList();
    }

    function deleteTask(index) {
        tasks.splice(index, 1);
        updateTaskList();
    }

    function filterTasks(category) {
        const filteredTasks = tasks.filter(task => task.category === category || category === 'all');
        updateTaskListWithTasks(filteredTasks);
    }

    function sortTasks() {
        tasks.sort((a, b) => {
            if (a.completed !== b.completed) {
                return a.completed ? 1 : -1;
            }
            return tasks.indexOf(a) - tasks.indexOf(b);
        });
        updateTaskList();
    }

    function updateTaskListWithTasks(taskArray) {
        const taskList = document.getElementById('taskList');
        taskList.innerHTML = '';
        taskArray.forEach((task, index) => {
            const categoryClass = `category-${task.category}`;
            const taskHTML = `
                <li class="${task.completed ? 'completed' : ''} ${categoryClass}">
                    <input type="checkbox" ${task.completed ? 'checked' : ''} onclick="toggleCompleted(${tasks.indexOf(task)})">
                    <span>${task.text}</span>
                    <span class="edit-button" onclick="editTask(${tasks.indexOf(task)})">✎</span>
                    <span class="delete-button" onclick="deleteTask(${tasks.indexOf(task)})">X</span>
                </li>
            `;
            taskList.innerHTML += taskHTML;
        });
    }
</script>
</body>
</html>